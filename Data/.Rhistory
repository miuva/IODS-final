train <- boston_scaled[ind,]
test <- boston_scaled[-ind,]
# Fitting the linear discriminant analysis on the train set
### Now I´ll fit a linear discriminant analysis with the function lda() and use the "crime" as target variable and other variables as predictors.
lda.fit <- lda(crime ~ ., data = train)
## The LDA biplot
### Here is the LDA biplot of this analysis
classes <- as.numeric(train$crime)
plot(lda.fit, dimen = 2, col = classes, pch = classes)
# Saving the crime categories and removing the categorical crime variable
### To save the crime categories from the test set I´ll create "correct_classes"
correct_classes <- test$crime
### After that I´ll remove the categorical crime variable from the test dataset.
test <- dplyr::select(test, -crime)
# Predicting the classes with the LDA model
### Next I will predict the classes with the LDA model on the test data using function predict()
lda.pred <- predict(lda.fit, newdata = test)
### Then I´ll cross tabulate the results
table(correct = correct_classes, predicted = lda.pred$class)
### So as you can see the predicted variables are columns and correct values are rows. If we look at first at the row where the correct value is low we can see that the most of the predicted values are in the class low (n=16) but there are also many values in the class med_low(12) and even some in the med_high (n=2) class. We can see same with the correct med_low class: most of the predicted values are on the med_low class (n=15) but almost as many are in the med_high group (n=14) and some in the low group (n=3). The situation with correct med_high and high classes is much better. In the correct med_high class there are 18 values in the predicted med_high class and only 2 in high class. In correct high class every value (n=20) is in the predicted high class.
# Distance measures
### At first I´ll reload the Boston data
data("Boston")
### After that I´ll scale the variables to get comparable distances as I did earlier in this exercise
boston_scaled <- scale(Boston)
### Then I´ll calculate the distances between the observations by creating an euclidean distance matrix
dist_eu <- dist(Boston)
# K-means
### Now I´ll first run the k-means algorithm where the number of clusters is 10
km <-kmeans(dist_eu, centers = 10)
pairs(Boston, col = km$cluster)
### The plot seems to be quite messy so maybe there are too many clusters
### To investigate the optimal number of clusters I will calculate the total within sum of squares
set.seed(123)
k_max <- 10
twcss <- sapply(1:k_max, function(k){kmeans(dist_eu, k)$tot.withinss})
plot(1:k_max, twcss, type='b')
### If we look at the plot we can see that the TWCSS drops radically when the number of clusters is two so that might be the optimal number of them.
### I will run the k-means algorithm again
km <-kmeans(dist_eu, centers = 2)
### Now if we draw the plot again we can see that they are much easier to interpret
pairs(Boston, col = km$cluster)
pairs(Boston, col = km$cluster)
hd <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human_development.csv", stringsAsFactors = F)
gii <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/gender_inequality.csv", stringsAsFactors = F, na.strings = "..")
str(hd)
dim(hd)
summary(hd)
str(gii)
dim(gii)
summary(gii)
library(dplyr)
str(hd)
summary(hd)
colnames(hd)
colnames(hd)[1] <- "HDIrank"
colnames(hd)[3] <- "HDI"
colnames(hd)[4] <- "LExpect"
colnames(hd)[5] <- "EExpect"
colnames(hd)[6] <- "EMean"
colnames(hd)[7] <- "GNI"
colnames(hd)[8] <- "GNIexHDI"
colnames(hd)
colnames(gii)
colnames(hd)[2] <- "HDCountry"
colnames(gii)[1] <- "GIIrank"
colnames(gii)[2] <- "GIICountry"
colnames(gii)[3] <- "GII"
colnames(gii)[4] <- "MMRatio"
colnames(gii)[5] <- "ABRate"
colnames(gii)[6] <- "Parliament"
colnames(gii)[7] <- "FSEdu"
colnames(gii)[8] <- "MSEdu"
colnames(gii)[9] <- "FLabourRate"
colnames(gii)[10] <- "MLabourRate"
colnames(gii)
colnames(gii)[5] <- "AdoBRate"
colnames(gii)
colnames(gii)[4] <- "MatMRatio"
colnames(gii)[7] <- "F2Edu"
colnames(gii)[8] <- "M2Edu"
colnames(hd)
colnames(hd)[4] <- "LifeExpect"
colnames(hd)[5] <- "EduExpect"
colnames(hd)[6] <- "EduMean"
colnames(gii)
gii <- mutate(gii, 2EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, 2EduRatio = (F2Edu / M2Edu)
Mutate the “Gender inequality” data and create two new variables.
The first one should be the ratio of Female and Male populations with secondary education in each country.
(i.e. edu2F / edu2M). The second new variable should be the ratio of labour force participation of females
and males in each country (i.e. labF / labM).
gii <- mutate(gii, 2EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, 2EduRatio = (F2Edu / M2Edu)
library(dplyr); library(ggplot2)
gii <- mutate(gii, 2EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, 2EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
# The ratio of labour force participation of females and males in each country
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate)
library(dplyr); library(ggplot2)
hd <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human_development.csv", stringsAsFactors = F)
str(hd)
dim(hd)
summary(hd)
colnames(hd)
colnames(hd)[1] <- "HDIrank"
colnames(hd)[2] <- "HDCountry"
colnames(hd)[3] <- "HDI"
colnames(hd)[4] <- "LifeExpect"
colnames(hd)[5] <- "EduExpect"
colnames(hd)[6] <- "EduMean"
colnames(hd)[7] <- "GNI"
colnames(hd)[8] <- "GNIexHDI"
colnames(hd)
gii <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/gender_inequality.csv", stringsAsFactors = F, na.strings = "..")
str(gii)
dim(gii)
summary(gii)
colnames(gii)
colnames(gii)[1] <- "GIIrank"
colnames(gii)[2] <- "GIICountry"
colnames(gii)[3] <- "GII"
colnames(gii)[4] <- "MatMRatio"
colnames(gii)[5] <- "AdoBRate"
colnames(gii)[6] <- "Parliament"
colnames(gii)[7] <- "F2Edu"
colnames(gii)[8] <- "M2Edu"
colnames(gii)[9] <- "FLabourRate"
colnames(gii)[10] <- "MLabourRate"
colnames(gii)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
# The ratio of labour force participation of females and males in each country
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
# The ratio of labour force participation of females and males in each country
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate)
gii <- mutate(gii, EduRatio = (F2Edu/M2Edu)
# The ratio of labour force participation of females and males in each country
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate)
gii <- mutate(gii, LabourRatio = (FLabourRate/MLabourRate)
colnames(gii)
colnames(gii)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
# The ratio of labour force participation of females and males in each country
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu)
# The ratio of labour force participation of females and males in each country
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu))
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate))
colnames(gii)
colnames(gii)[2] <- "Country"
colnames(hd)[2] <- "Country"
human <- inner_join(hd, gii, by = Country, suffix = c(".hd", ".gii"))
colnames(hd)[2] <- "HDCountry"
colnames(gii)[2] <- "GIICountry"
colnames(gii)[2] <- "Country"
colnames(hd)[2] <- "Country"
human <- inner_join(hd, gii, by = "Country", suffix = c(".hd", ".gii"))
colnames(human)
gii <- select(human, one_of("Country"))
library(dplyr)
hd <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human_development.csv", stringsAsFactors = F)
str(hd)
dim(hd)
summary(hd)
colnames(hd)
colnames(hd)[1] <- "HDIrank"
colnames(hd)[2] <- "Country"
colnames(hd)[3] <- "HDI"
colnames(hd)[4] <- "LifeExpect"
colnames(hd)[5] <- "EduExpect"
colnames(hd)[6] <- "EduMean"
colnames(hd)[7] <- "GNI"
colnames(hd)[8] <- "GNIexHDI"
colnames(hd)
gii <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/gender_inequality.csv", stringsAsFactors = F, na.strings = "..")
str(gii)
dim(gii)
summary(gii)
colnames(gii)
colnames(gii)[1] <- "GIIrank"
colnames(gii)[2] <- "Country"
colnames(gii)[3] <- "GII"
colnames(gii)[4] <- "MatMRatio"
colnames(gii)[5] <- "AdoBRate"
colnames(gii)[6] <- "Parliament"
colnames(gii)[7] <- "F2Edu"
colnames(gii)[8] <- "M2Edu"
colnames(gii)[9] <- "FLabourRate"
colnames(gii)[10] <- "MLabourRate"
colnames(gii)
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu))
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate))
human_join <- inner_join(hd, gii, by = "Country", suffix = c(".hd", ".gii"))
colnames(human)
colnames(human_join)
human <- select(human_join, one_of("Country"))
notjoined_columns <- colnames(gii)[!colnames(gii) %in% join_by]
notjoined_columns <- colnames(gii)[!colnames(gii) %in% "Country"]
notjoined_columns
?inner_join
?inner_join()
library(dplyr)
# Reading the Human development data into R
hd <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human_development.csv", stringsAsFactors = F)
# Structure, dimensions and the summary of the hd
str(hd)
dim(hd)
summary(hd)
# Changing the column names of the hd data
colnames(hd)
colnames(hd)[1] <- "HDIrank"
colnames(hd)[2] <- "Country"
colnames(hd)[3] <- "HDI"
colnames(hd)[4] <- "LifeExpect"
colnames(hd)[5] <- "EduExpect"
colnames(hd)[6] <- "EduMean"
colnames(hd)[7] <- "GNI"
colnames(hd)[8] <- "GNIexHDI"
colnames(hd)
# Reading the Gender inequality data into R
gii <- read.csv("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/gender_inequality.csv", stringsAsFactors = F, na.strings = "..")
# Structure, dimensions and the summary of the gii
str(gii)
dim(gii)
summary(gii)
# Changing the column names of the gii data
colnames(gii)
colnames(gii)[1] <- "GIIrank"
colnames(gii)[2] <- "Country"
colnames(gii)[3] <- "GII"
colnames(gii)[4] <- "MatMRatio"
colnames(gii)[5] <- "AdoBRate"
colnames(gii)[6] <- "Parliament"
colnames(gii)[7] <- "F2Edu"
colnames(gii)[8] <- "M2Edu"
colnames(gii)[9] <- "FLabourRate"
colnames(gii)[10] <- "MLabourRate"
colnames(gii)
# Creating two new variables to gii data
# The ratio of Female and Male populations with secondary education in each country
gii <- mutate(gii, EduRatio = (F2Edu / M2Edu))
# The ratio of labour force participation of females and males in each country
gii <- mutate(gii, LabourRatio = (FLabourRate / MLabourRate))
#Join together the two datasets using the variable Country as the identifier.
# Joining the datasets
human <- inner_join(hd, gii, by = "Country", suffix = c(".hd", ".gii"))
colnames(human)
?read.table
human <- read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human1.txt", sep=",", header=TRUE)
library(stringr)
human <- mutate(human, (str_replace(human$GNI, pattern=",", replace ="") %>% as.numeric))
library(stringr); library(dplyr)
human <- mutate(human, (str_replace(human$GNI, pattern=",", replace ="") %>% as.numeric))
str(human$GNI)
human <- mutate(human, (str_replace(human$GNI) %>% as.numeric))
keep <- c("Country", "Edu2.FM", "Labo.FM", "Life.Exp", "Edu.Exp", "GNI", "Mat.Mor", "Ado.Birth", "Parli.F")
human <- select(human, one_of(keep))
complete.cases(human)
data.frame(human[-1], comp = complete.cases(human))
human_ <- filter(human, complete.cases(human))
library(stringr); library(dplyr)
human <- read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human1.txt", sep=",", header=TRUE)
str_replace(human$GNI, pattern=",", replace ="") %>% as.numeric)
str_replace(human$GNI, pattern=",", replace ="") %>% as.numeric
keep <- c("Country", "Edu2.FM", "Labo.FM", "Life.Exp", "Edu.Exp", "GNI", "Mat.Mor", "Ado.Birth", "Parli.F")
human <- select(human, one_of(keep))
complete.cases(human)
data.frame(human[-1], comp = complete.cases(human))
human_ <- filter(human, complete.cases(human))
str(human_$Country)
dim(human_$Country)
summary(human_$Country)
human_c <- human_[1:43, 45:49, 51:55, 57:86, 88:162]
human_c <- human_[1:43, 45:49, 51:55, 57:86, 88:162, ]
human_c <- human_[1:43, 45:49, 51:55, 57:86, 88:162, ]
print(human_$Country)
human_ex <- human_[c(1:43, 45:49, 51:55, 57:86, 88:162, )]
human_ex <- human_[c(1:43, 45:49, 51:55, 57:86, 88:162)]
human_ex <- human_[c(1:43, 45:49, 51:55, 57:86, 88:161)]
library(FactoMineR)
data("tea")
str(tea)
dim(tea)
str(tea$tea.time)
summary(tea$tea.time)
summary(tea$SPC)
par(mfrow=c(1,4))
for(i in 1:4) {
hist(tea[,i], main=names(tea)[i])
}
plot(density(tea))
plot(tea)
plot(tea$breakfast)
bartable = table(tea)  ## get the cross tab
keep_columns <- c("tea.time", "always", "tearoom", Tea", "How", "sugar", "how", "where")
# select the 'keep_columns' to create a new dataset
tea_time <- select(tea, one_of(keep_columns))
# look at the summaries and structure of the data
summary(tea_time)
str(tea_time)
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
keep_columns)
str(keep_columns)
keep_columns <- c("tea.time", "always", "tearoom", Tea", "How", "sugar", "how", "where")
str(keep_columns)
library(FactoMineR)
library(GGally); library(dplyr); library(corrplot)
library(FactoMineR); library(tidyr); library(ggplot2)
data("tea")
str(tea)
dim(tea)
keep_columns <- c("tea.time", "always", "tearoom", Tea", "How", "sugar", "how", "where")
keep_columns <- c("tea.time", "always", "tearoom", "Tea", "How", "sugar", "how", "where")
str(keep_columns)
dim(keep_columns)
data("tea")
keep_columns <- c("tea.time", "always", "tearoom", "Tea", "How", "sugar", "how", "where")
str(keep_columns)
tea_time <- select(tea, one_of(keep_columns))
summary(tea_time)
str(tea_time)
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
keep_columns <- c("tea.time", "tearoom", "Tea", "How", "sugar", "how", "where")
tea_time <- select(tea, one_of(keep_columns))
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
mca <- MCA(tea_time, graph = FALSE)
summary(mca)
for (i in 1:ncol(tea_time)) {
plot(tea_time[,i], main=colnames(tea_time)[i],
ylab = "Count", col="steelblue", las = 2)
}
plot(mca, invisible=c("ind"), habillage = "quali")
plot(mca, invisible=c("ind"))
plot(mca, invisible=c("ind"), habillage = "quali")
library(FactoMineR)
library(dplyr)
library(tidyr)
data("tea")
str(tea)
keep_columns <- c("Tea", "evening", "price", "sugar", "sex")
tea_time <- select(tea, one_of(keep_columns))
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
mca <- MCA(tea_time, graph = FALSE)
plot(mca, invisible=c("ind"))
x <- 0:20
# Kokonaisluvut 0:sta 20:een
f <- dpois(x,4)
# Lasketaan pistetodennäköisyydet
plot(x,f,type="b")  # Piirretään
str(f)
summary(f)
median(f)
mean(f)
mode(f)
mean(x)
median(x)
mode(x)
Mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
Mode(x)
getwd()
getwd()
setwd("/Users/mirva/IODS-Final/Data")
school <- read.csv("school")
str(school)
library(ggplot2)
g1 <- ggplot(data = school, aes(x = q6_7, fill = q1))
g1 + geom_bar(width = .6, position = "dodge")
g1 + geom_bar(width = .6, position = "dodge")
+ labs(x = "", y = "Count", title ="Q6_7", subtitle = "The rules of the school are reasonable",
caption = "Figure 1: The most popular answer here is 4 = agree and the least popular is 1 = strongly \n disagree. More boys than girls seem to answer 1 = strongly disagree.", fill = "Gender")
+ theme(plot.caption = element_text(hjust = 0.5))
library(ggplot2)
g1 + geom_bar(width = .6, position = "dodge")
+ labs(x = "", y = "Count", title ="Q6_7", subtitle = "The rules of the school are reasonable",
caption = "Figure 1: The most popular answer here is 4 = agree and the least popular is 1 = strongly \n disagree. More boys than girls seem to answer 1 = strongly disagree.", fill = "Gender")
+ theme(plot.caption = element_text(hjust = 0.5))
g1 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q6_7", subtitle = "The rules of the school are reasonable", caption = "Figure 1: The most popular answer here is 4 = agree and the least popular is 1 = strongly \n disagree. More boys than girls seem to answer 1 = strongly disagree.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g2 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q6_8", subtitle = "The punishments of the school are fair", caption = "Figure 2: The most popular answer here is 4 = agree and 3 = neither agree nor disagree \n is also quite popular. Girls seem to think punishments fairer than boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g2 <- ggplot(data = school, aes(x = q6_8, fill = q1))
g2 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q6_8", subtitle = "The punishments of the school are fair", caption = "Figure 2: The most popular answer here is 4 = agree and 3 = neither agree nor disagree \n is also quite popular. Girls seem to think punishments fairer than boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g3 <- ggplot(data = school, aes(x = q7_9, fill = q1))
g3 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q7_9", subtitle = "The teachers treat us with justice", caption = "Figure 3: The most popular answer here is 4 = agree and the least popular is 1 = strongly \n disagree. Girls have answered more often 4 = agree than boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g3 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q7_9", subtitle = "The teachers treat us with justice", caption = "Figure 3: The most popular answer here is 4 = agree and the least popular is 1 = strongly \n disagree. Girls have answered more often 4 = agree than boys and boys have \n answered more often 1 = strongly disagree.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g4 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q7_10", subtitle = "It is easy to get along with the teachers", caption = "Figure 4: The most popular answer here is 4 = agree and and only few have \n answered 1 = strongly disagree. Girls and boys have answered here almost \n as equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g4 <- ggplot(data = school, aes(x = q7_10, fill = q1))
g4 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q7_10", subtitle = "It is easy to get along with the teachers", caption = "Figure 4: The most popular answer here is 4 = agree and and only few have \n answered 1 = strongly disagree. Girls and boys have answered here almost \n as equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g5 <- ggplot(data = school, aes(x = q7_11, fill = q1))
g5 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q7_11", subtitle = "Most of the teachers are interested in how I feel",  caption = "Figure 5: The answers 3= neither agree or disagree and 4 = agree are the most popular \n ones in this question. Also here girls and boys have answered almost as equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g6 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q7_12", subtitle = "Most of the teachers are friendly", caption = "Figure 6: The answer 4 = agree is the most popular here and also the answer  5 = strongly agree \n is quite popular.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g6 <- ggplot(data = school, aes(x = q7_12, fill = q1))
g6 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q7_12", subtitle = "Most of the teachers are friendly", caption = "Figure 6: The answer 4 = agree is the most popular here and also the answer  5 = strongly agree \n is quite popular.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g6 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q7_12", subtitle = "Most of the teachers are friendly", caption = "Figure 6: The answer 4 = agree is the most popular here and also the answer  5 = strongly agree \n is quite popular. There aren´t big differences between gendes.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g7 <- ggplot(data = school, aes(x = q10_1, fill = q1))
g7 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_1", subtitle = "My parents appreciate my schoolwork",  caption = "Figure 7: The answers 5 = strongly agree and 4 = agree are the most popular ones \n but there are also few who have answered 1 = strongly disagree", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g7 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_1", subtitle = "My parents appreciate my schoolwork",  caption = "Figure 7: The answers 5 = strongly agree and 4 = agree are the most popular ones. \n  Girls have answered more often 5 = strongly agree.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g8 <- ggplot(data = school, aes(x = q10_2, fill = q1))
g8 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_2", subtitle = "My parents encourage me to do well at school",  caption = "Figure 8: Also here the answer 5 = strongly agree is the most popular one \n and only minority has answered 1 = strongly disagree or 2 = disagree.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g8 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_2", subtitle = "My parents encourage me to do well at school",  caption = "Figure 8: Also here the answer 5 = strongly agree is the most popular one \n and only a small minority has answered 1 = strongly disagree or 2 = disagree. \n Girls and boys have answered almost as equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g9 <- ggplot(data = school, aes(x = q10_3, fill = q1))
g9 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_3", subtitle = "My parents help me with my homework if necessary",  caption = "Figure 9: The answer 5 = strongly agree is the most popular one and also the answer \n 4 = agree is quite popular.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g9 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_3", subtitle = "My parents help me with my homework if necessary",  caption = "Figure 9: The answer 5 = strongly agree is the most popular one and also the answer \n 4 = agree is quite popular. There are no big differences between genders.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g10 <- ggplot(data = school, aes(x = q10_4, fill = q1))
g10 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_4", subtitle = "My parents help me with problems related to school if necessary",  caption = "Figure 10: The answers 5 = strongly agree and 4 = agree are the most popular ones here.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g10 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_4", subtitle = "My parents help me with problems related to school if necessary",  caption = "Figure 10: The answers 5 = strongly agree and 4 = agree are the most popular ones here. \n And there is no big differences between boys and girls.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g11 <- ggplot(data = school, aes(x = q10_5, fill = q1))
g11 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_5", subtitle = "My parents are willing to come to the school to talk with a teacher if necessary",  caption = "Figure 11: Here the answer 5 = strongly agree is the most popular and almost \n as popular is the answer 4 = agree.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g11 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q10_5", subtitle = "My parents are willing to come to the school to talk with a teacher if necessary",  caption = "Figure 11: Here the answer 5 = strongly agree is the most popular and almost \n as popular is the answer 4 = agree. Girls have answered more often 5 = strongly agree.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g12 <- ggplot(data = school, aes(x = q11_1, fill = q1))
g12 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_1", subtitle = "My work is appreciated at school",  caption = "Figure 12: Here the answer 5 = strongly agree is the most popular and almost \n as popular is the answer 4 = agree.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g12 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_1", subtitle = "My work is appreciated at school",  caption = "Figure 12: Here the answer 5 = strongly agree is the most popular and almost \n as popular is the answer 4 = agree. There are no big differences between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g13 <- ggplot(data = school, aes(x = q11_2, fill = q1))
g13 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_2", subtitle = "At school I´m regarded as a person who has a meaninge",  caption = "Figure 12: Here the answer 5 = strongly agree is the most popular and almost \n as popular is the answer 4 = agree. There are no big differences between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g13 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_2", subtitle = "At school I´m regarded as a person who has a meaninge",  caption = "Figure 13: Here the answers 4 = agree and 3 = neither agree or disagree \n are the most popular ones. Boys seem to be little more confident than girls. ", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g14 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_3", subtitle = "The teachers encourage me to tell my opinion",  caption = "Figure 14: Here the answers 4 = agree and 3 = neither agree or disagree \n are the most popular ones. Boys seem to be little more confident than girls. ", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g14 <- ggplot(data = school, aes(x = q11_3, fill = q1))
g14 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_3", subtitle = "The teachers encourage me to tell my opinion",  caption = "Figure 14: Here the answers 4 = agree and 3 = neither agree or disagree \n are the most popular ones. Boys seem to be little more confident than girls. ", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g14 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_3", subtitle = "The teachers encourage me to tell my opinion",  caption = "Figure 14: Also here answer 4 = agree is the most popular one and girls and boys have answered almost as equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g14 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_3", subtitle = "The teachers encourage me to tell my opinion",  caption = "Figure 14: Also here answer 4 = agree is the most popular one and girls and boys have \n answered almost as equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g15 <- ggplot(data = school, aes(x = q11_15, fill = q1))
g15 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_15", subtitle = "A teacher helps me if I need it",  caption = "Figure 15: Also here answer 4 = agree is the most popular one and girls and boys have \n answered almost as equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g15 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_15", subtitle = "A teacher helps me if I need it",  caption = "Figure 15: The most popular answer here is 4 = agree and girls and boys have answered almost equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g15 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_15", subtitle = "A teacher helps me if I need it",  caption = "Figure 15: The most popular answer here is 4 = agree and girls and boys have \n answered almost equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g16 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_16", subtitle = "I receive remediation if I need it",  caption = "Figure 16: The most popular answer here is 4 = agree and girls and boys have \n answered almost equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g16 <- ggplot(data = school, aes(x = q11_16, fill = q1))
g16 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_16", subtitle = "I receive remediation if I need it",  caption = "Figure 16: The most popular answer here is 4 = agree and girls and boys have \n answered almost equally.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g16 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_16", subtitle = "I receive remediation if I need it",  caption = "Figure 16: As in earlier figures most of the answers are neutral (3) \ nor positive (4 and 5) and there is no big difference between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g16 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_16", subtitle = "I receive remediation if I need it",  caption = "Figure 16: As in earlier figures most of the answers are neutral (3) \n or positive (4 and 5) and there is no big difference between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g16 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_16", subtitle = "I receive remediation if I need it",  caption = "Figure 16: As in earlier figures most of the answers are neutral (3) or \n positive (4 and 5) and there is no big difference between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g17 <- ggplot(data = school, aes(x = q11_17, fill = q1))
g17 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_17", subtitle = "I receive special education if I need it",  caption = "Figure 17:", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g17 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_17", subtitle = "I receive special education if I need it",  caption = "Figure 17: Also here the answer 4 = agree is the most popular one. \n There are only few who have answered 1 = strongly disagree or 2 = disagree. And there aren´t big differences between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g17 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_17", subtitle = "I receive special education if I need it",  caption = "Figure 17: Also here the answer 4 = agree is the most popular one. \n There are only few who have answered 1 = strongly disagree or 2 = disagree. \n And there aren´t big differences between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g18 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_18", subtitle = "I receive quidance if I need it",  caption = "Figure 18: Also here the answer 4 = agree is the most popular one. \n There are only few who have answered 1 = strongly disagree or 2 = disagree. \n And there aren´t big differences between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g18 <- ggplot(data = school, aes(x = q11_18, fill = q1))
g18 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_18", subtitle = "I receive quidance if I need it",  caption = "Figure 18: Also here the answer 4 = agree is the most popular one. \n There are only few who have answered 1 = strongly disagree or 2 = disagree. \n And there aren´t big differences between girls and boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g18 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_18", subtitle = "I receive quidance if I need it",  caption = "Figure 18: If we look at this figure we can see that the answer 4 = agree is the most popular one and there aren´t big differences between genders.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g18 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_18", subtitle = "I receive quidance if I need it",  caption = "Figure 18: If we look at this figure we can see that the answer \n 4 = agree is the most popular one and there aren´t big differences between genders.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g18 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_18", subtitle = "I receive quidance if I need it",  caption = "Figure 18: If we look at this figure we can see that the answer 4 = agree \n is the most popular one and there aren´t big differences between genders.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g19 <- ggplot(data = school, aes(x = q11_19, fill = q1))
g19 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_19", subtitle = "The teachers encourage me with studying",  caption = "Figure 19: If we look at this figure we can see that the answer 4 = agree \n is the most popular one and there aren´t big differences between genders.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g20 <- ggplot(data = school, aes(x = q11_20, fill = q1))
g20 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_20", subtitle = "The teachers encourage me with studying",  caption = "Figure 19: Also here the positive answers are the most common ones. Here the boys seem to feel slightly more encouraged than girls.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g20 <- ggplot(data = school, aes(x = q11_20, fill = q1))
g20 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_20", subtitle = "I reserve acknowledgement if I do well with my tasks",  caption = "Figure 20: Also here the positive answers are the most common ones. Here the boys seem to feel slightly more encouraged than girls.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g20 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_20", subtitle = "I reserve acknowledgement if I do well with my tasks",  caption = "Figure 20: Here the answer 4 is the most common one and there are no big differences between girls and boys", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g20 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q11_20", subtitle = "I reserve acknowledgement if I do well with my tasks",  caption = "Figure 20: Here the answer 4 is the most common one \n and there are no big differences between girls and boys", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g21 <- ggplot(data = school, aes(x = q13_4, fill = q1))
g21 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_4", subtitle = "Tension or nervousness",  caption = "Figure 20: Here the answer 4 is the most common one \n and there are no big differences between girls and boys", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g21 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_4", subtitle = "Tension or nervousness",  caption = "Figure 21: Most of the boys don´t have had tension or nervousness \n during the semester or just rarely. The situation is quite different \n among girls; many of them have these symptoms rarely or monthly \n but there are also many who feel them weekly or even daily.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g22 <- ggplot(data = school, aes(x = q13_5, fill = q1))
g22 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_5", subtitle = "Irritability or outbursts of anger",  caption = "Figure 22: ", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g23 <- ggplot(data = school, aes(x = q13_6, fill = q1))
g23 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_6", subtitle = "Problems with falling asleep or waking up at night time",  caption = "Figure 23: ", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g23 <- ggplot(data = school, aes(x = q13_6, fill = q1))
g23 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_6", subtitle = "Problems with falling asleep or waking up at night time",  caption = "Figure 23: Sleep problems seem also to be more common among girls than boys. \n Many of boys and also girls have them never or just rarely but \n some of them have them weekly or daily.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g24 <- ggplot(data = school, aes(x = q13_8, fill = q1))
g24 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_8", subtitle = "Tiredness or weakness",  caption = "Figure 24: ", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g24 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_8", subtitle = "Tiredness or weakness",  caption = "Figure 24: Here the distributions between girls and boys are very different. \n Many of the girls have tiredness or weakness weekly or even daily. \n Boys have these symtpoms much more rarely or even never.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g25 <- ggplot(data = school, aes(x = q13_9, fill = q1))
g25 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_9", subtitle = "Depression",  caption = "Figure 25: ", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g25 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_9", subtitle = "Depression",  caption = "Figure 25: Depression doesn´t seem to be so common symptom \n as the symptoms mentioned earlier. Most of the pupils have it \n never or only rarely. Girls seem to have it slightly more often than boys.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g26 <- ggplot(data = school, aes(x = q13_10, fill = q1))
g26 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_10", subtitle = "Fear",  caption = "Figure 26: ", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
g23 + geom_bar(width = .6, position = "dodge") + labs(x = "", y = "Count", title ="Q13_6", subtitle = "Problems with falling asleep or waking up at night time",  caption = "Figure 23: Sleep problems seem also to be more common among girls than boys. \n Many of boys and also girls have them never or just rarely but \n some of them have them weekly or daily.", fill = "Gender") + theme(plot.caption = element_text(hjust = 0.5))
tn1 <- glm(q13_4often ~ q1 + q6_7 + q6_8 + q7_9 + q7_10 + q7_11 + q7_12 + q10_1 + q10_2 + q10_3 + q10_4 + q10_5 + q11_1 + q11_2 + q11_3 + q11_15 + q11_16 + q11_17 + q11_18 + q11_19 + q11_20, data = school, family = "binomial")
summary.glm(tn1)
coef(tn1)
step(glm,direction="both",test="F")
step(glm, direction="backward", test="F")
step(tn1, direction="backward", test="F")
step(tn1, direction="backward")
?step
step(tn1, direction="both")
tn1 <- glm(q13_4often ~ q1 + q6_7 + q6_8 + q7_9 + q7_10 + q7_11 + q7_12 + q10_1 + q10_2 + q10_3 + q10_4 + q10_5 + q11_1 + q11_2 + q11_3 + q11_15 + q11_16 + q11_17 + q11_18 + q11_19 + q11_20, data = school, family = "binomial")
step(tn1, direction="backward")
summary.glm(tn1)
m1 <- glm(q13_4often ~ q1 + q6_7 + q6_8 + q7_9 + q7_10 + q7_11 + q7_12 + q10_1 + q10_2 + q10_3 + q10_4 + q10_5 + q11_1 + q11_2 + q11_3 + q11_15 + q11_16 + q11_17 + q11_18 + q11_19 + q11_20, data = school, family = "binomial")
sm1 step(m1, direction="backward")
sm1 <- step(m1, direction="backward")
summary.glm(sm1)
coef(sm1)
sm1 <- step(m1, direction="both")
summary.glm(sm1)
m2 <- glm(q13_5often ~ q1 + q6_7 + q6_8 + q7_9 + q7_10 + q7_11 + q7_12 + q10_1 + q10_2 + q10_3 + q10_4 + q10_5 + q11_1 + q11_2 + q11_3 + q11_15 + q11_16 + q11_17 + q11_18 + q11_19 + q11_20, data = school, family = "binomial")
sm2 <- step(m2, direction="both")
summary.glm(sm2)
coef(sm2)
m3 <- glm(q13_6often ~ q1 + q6_7 + q6_8 + q7_9 + q7_10 + q7_11 + q7_12 + q10_1 + q10_2 + q10_3 + q10_4 + q10_5 + q11_1 + q11_2 + q11_3 + q11_15 + q11_16 + q11_17 + q11_18 + q11_19 + q11_20, data = school, family = "binomial")
sm3 <- step(m3, direction="both")
summary.glm(sm3)
m4 <- glm(q13_8often ~ q1 + q6_7 + q6_8 + q7_9 + q7_10 + q7_11 + q7_12 + q10_1 + q10_2 + q10_3 + q10_4 + q10_5 + q11_1 + q11_2 + q11_3 + q11_15 + q11_16 + q11_17 + q11_18 + q11_19 + q11_20, data = school, family = "binomial")
sm4 <- step(m4, direction="both")
summary.glm(sm4)
m5 <- glm(q13_9often ~ q1 + q6_7 + q6_8 + q7_9 + q7_10 + q7_11 + q7_12 + q10_1 + q10_2 + q10_3 + q10_4 + q10_5 + q11_1 + q11_2 + q11_3 + q11_15 + q11_16 + q11_17 + q11_18 + q11_19 + q11_20, data = school, family = "binomial")
sm5 <- step(m5, direction="both")
summary.glm(sm5)
m6 <- glm(q13_10often ~ q1 + q6_7 + q6_8 + q7_9 + q7_10 + q7_11 + q7_12 + q10_1 + q10_2 + q10_3 + q10_4 + q10_5 + q11_1 + q11_2 + q11_3 + q11_15 + q11_16 + q11_17 + q11_18 + q11_19 + q11_20, data = school, family = "binomial")
sm6 <- step(m6, direction="both")
summary.glm(sm6)
coef(sm6)
